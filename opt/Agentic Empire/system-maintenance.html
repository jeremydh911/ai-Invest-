<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>System Maintenance - Agentic Empire</title>
  <link rel="stylesheet" href="/styles.css">
  <style>
    .maintenance-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      margin-bottom: 2rem;
    }
    .maintenance-card {
      background: white;
      padding: 2rem;
      border-radius: 8px;
      box-shadow: var(--shadow-sm);
    }
    .maintenance-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: #667eea;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 0.5rem;
    }
    .status-online {
      background: #28a745;
    }
    .status-warning {
      background: #ffc107;
    }
    .status-offline {
      background: #dc3545;
    }
    .maintenance-info {
      color: #666;
      font-size: 0.95rem;
      margin-bottom: 1.5rem;
      line-height: 1.6;
    }
    .maintenance-stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }
    .stat-item {
      background: #f9f9f9;
      padding: 1rem;
      border-radius: 4px;
      text-align: center;
    }
    .stat-value {
      font-weight: 700;
      color: #667eea;
      font-size: 1.5rem;
    }
    .stat-label {
      color: #999;
      font-size: 0.85rem;
      margin-top: 0.25rem;
    }
    .action-button {
      width: 100%;
      padding: 0.75rem;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition);
    }
    .action-button:hover {
      background: #5568d3;
    }
    .action-button.secondary {
      background: #f0f0f0;
      color: #333;
    }
    .action-button.secondary:hover {
      background: #e0e0e0;
    }
    .action-button.danger {
      background: #dc3545;
    }
    .action-button.danger:hover {
      background: #c82333;
    }
  </style>
</head>
<body>
  <div class="navbar">
    <h1>ğŸ”§ System Maintenance</h1>
    <div class="navbar-menu">
      <a href="/dashboard.html">â† Dashboard</a>
      <a href="/settings.html">Settings</a>
      <button onclick="logout()">Logout</button>
    </div>
  </div>

  <div class="container">
    <h2>System Health & Maintenance</h2>
    
    <div class="maintenance-grid">
      <!-- Database Health -->
      <div class="maintenance-card">
        <div class="maintenance-title">
          <span class="status-indicator status-online"></span>
          ğŸ’¾ Database
        </div>
        <div class="maintenance-info">
          SQLite database storing all application data, users, and configurations.
        </div>
        <div class="maintenance-stats">
          <div class="stat-item">
            <div class="stat-value">2.3 GB</div>
            <div class="stat-label">Size</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">99.2%</div>
            <div class="stat-label">Health</div>
          </div>
        </div>
        <button class="action-button" onclick="backupDatabase()">ğŸ’¾ Backup Now</button>
        <button class="action-button secondary" onclick="optimizeDatabase()" style="margin-top: 0.5rem;">ğŸ§¹ Optimize</button>
      </div>

      <!-- File Storage -->
      <div class="maintenance-card">
        <div class="maintenance-title">
          <span class="status-indicator status-online"></span>
          ğŸ“ File Storage
        </div>
        <div class="maintenance-info">
          Local file storage for documents, RAG embeddings, and uploaded files.
        </div>
        <div class="maintenance-stats">
          <div class="stat-item">
            <div class="stat-value">45.2 GB</div>
            <div class="stat-label">Used</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">154.8 GB</div>
            <div class="stat-label">Available</div>
          </div>
        </div>
        <button class="action-button" onclick="cleanupStorage()">ğŸ—‘ï¸ Cleanup</button>
        <button class="action-button secondary" onclick="viewStorageStats()" style="margin-top: 0.5rem;">ğŸ“Š Details</button>
      </div>

      <!-- API Services -->
      <div class="maintenance-card">
        <div class="maintenance-title">
          <span class="status-indicator status-online"></span>
          ğŸ”— API Services
        </div>
        <div class="maintenance-info">
          External API integrations (OpenAI, Ollama, embedding services).
        </div>
        <div class="maintenance-stats">
          <div class="stat-item">
            <div class="stat-value">3/3</div>
            <div class="stat-label">Connected</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">100%</div>
            <div class="stat-label">Uptime</div>
          </div>
        </div>
        <button class="action-button" onclick="testAPIs()">ğŸ§ª Test APIs</button>
        <button class="action-button secondary" onclick="viewAPILogs()" style="margin-top: 0.5rem;">ğŸ“œ Logs</button>
      </div>

      <!-- Cache System -->
      <div class="maintenance-card">
        <div class="maintenance-title">
          <span class="status-indicator status-online"></span>
          âš¡ Cache System
        </div>
        <div class="maintenance-info">
          In-memory cache for improved performance and response times.
        </div>
        <div class="maintenance-stats">
          <div class="stat-item">
            <div class="stat-value">512 MB</div>
            <div class="stat-label">Used</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">89.3%</div>
            <div class="stat-label">Hit Rate</div>
          </div>
        </div>
        <button class="action-button" onclick="clearCache()">ğŸ§¹ Clear Cache</button>
        <button class="action-button secondary" onclick="viewCacheStats()" style="margin-top: 0.5rem;">ğŸ“Š Stats</button>
      </div>

      <!-- Backup & Recovery -->
      <div class="maintenance-card">
        <div class="maintenance-title">
          <span class="status-indicator status-online"></span>
          ğŸ”„ Backup & Recovery
        </div>
        <div class="maintenance-info">
          System backups and disaster recovery procedures.
        </div>
        <div class="maintenance-stats">
          <div class="stat-item">
            <div class="stat-value">24</div>
            <div class="stat-label">Backups</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">Jan 20</div>
            <div class="stat-label">Latest</div>
          </div>
        </div>
        <button class="action-button" onclick="createBackup()">ğŸ“¦ Create Backup</button>
        <button class="action-button secondary" onclick="restoreBackup()" style="margin-top: 0.5rem;">â†©ï¸ Restore</button>
      </div>

      <!-- Updates & Patches -->
      <div class="maintenance-card">
        <div class="maintenance-title">
          <span class="status-indicator status-online"></span>
          ğŸš€ Updates & Patches
        </div>
        <div class="maintenance-info">
          System updates, security patches, and version management.
        </div>
        <div class="maintenance-stats">
          <div class="stat-item">
            <div class="stat-value">v2.1.0</div>
            <div class="stat-label">Current</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">Up to date</div>
            <div class="stat-label">Status</div>
          </div>
        </div>
        <button class="action-button" onclick="checkUpdates()">ğŸ” Check Updates</button>
        <button class="action-button secondary" onclick="viewChangelog()" style="margin-top: 0.5rem;">ğŸ“‹ Changelog</button>
      </div>
    </div>

    <!-- Danger Zone -->
    <div style="background: #fff3cd; padding: 1.5rem; border-radius: 8px; margin-top: 2rem; border-left: 4px solid #ffc107;">
      <h3 style="color: #856404; margin-top: 0;">âš ï¸ Danger Zone</h3>
      <p style="color: #856404; margin-bottom: 1rem;">These actions cannot be easily undone. Proceed with caution.</p>
      <button class="action-button danger" onclick="resetSystem()">ğŸ”„ Reset System</button>
      <button class="action-button danger" onclick="deleteAllData()" style="margin-left: 0.5rem;">ğŸ—‘ï¸ Delete All Data</button>
    </div>
  </div>

  <script>
    const token = localStorage.getItem('token');
    if (!token) window.location.href = '/login.html';

    function backupDatabase() {
      alert('ğŸ’¾ Creating database backup...\n\nBackup started: 2026-01-20 14:35:22\nEstimated time: 2 minutes\nBackup location: /backups/db_20260120_143522.sql');
    }

    function optimizeDatabase() {
      alert('ğŸ§¹ Optimizing database...\n\nDefragmentation in progress...\n\nCompleted: 95%\nDuration: 3 minutes\nSpace saved: 150 MB');
    }

    function cleanupStorage() {
      alert('ğŸ—‘ï¸ Cleaning up storage...\n\nScanning for old files...\nTemporary files: 2.3 GB\nOld logs: 500 MB\n\nProceed with cleanup?');
    }

    function viewStorageStats() {
      alert('ğŸ“Š Storage Statistics:\n\nDocuments: 23.4 GB\nEmbeddings: 15.8 GB\nLogs: 4.2 GB\nTemp files: 1.8 GB');
    }

    function testAPIs() {
      alert('ğŸ§ª Testing APIs...\n\nOpenAI: âœ“ Connected\nOllama: âœ“ Connected\nEmbedding Service: âœ“ Connected\n\nAll services healthy!');
    }

    function viewAPILogs() {
      alert('ğŸ“œ API Integration Logs\n\nLatest calls:\n2026-01-20 14:32:15 - OpenAI completion\n2026-01-20 14:28:43 - Embedding generation\n2026-01-20 14:15:22 - Ollama inference');
    }

    function clearCache() {
      alert('âš¡ Clearing cache...\n\nCache items: 1,247\nEstimated space: 512 MB\n\nClear cache? This will temporarily slow down performance.');
    }

    function viewCacheStats() {
      alert('ğŸ“Š Cache Statistics:\n\nTotal items: 1,247\nMemory used: 512 MB\nHit rate: 89.3%\nMiss rate: 10.7%\nAvg access time: 2.3ms');
    }

    function createBackup() {
      alert('ğŸ“¦ Creating system backup...\n\nBackup scheduled\nEstimated duration: 10 minutes\nYou will be notified when complete.');
    }

    function restoreBackup() {
      alert('â†©ï¸ Restore from backup?\n\nAvailable backups:\n1. 2026-01-20 12:00:00\n2. 2026-01-19 12:00:00\n3. 2026-01-18 12:00:00\n\nSelect backup to restore.');
    }

    function checkUpdates() {
      alert('ğŸ” Checking for updates...\n\nCurrent version: v2.1.0\nLatest version: v2.1.0\n\nYou are running the latest version!');
    }

    function viewChangelog() {
      alert('ğŸ“‹ Recent Changes:\n\nv2.1.0 - Jan 15, 2026\n- Added workflow builder\n- Improved search performance\n- Fixed security issues\n\nv2.0.5 - Jan 1, 2026\n- Bug fixes and optimizations');
    }

    function resetSystem() {
      if (confirm('ğŸ”„ Reset entire system to factory settings?\n\nThis will:\n- Clear all data\n- Reset configurations\n- Restart services\n\nThis action CANNOT be undone!')) {
        alert('System reset initiated. This will take 5 minutes.');
      }
    }

    function deleteAllData() {
      if (confirm('ğŸ—‘ï¸ PERMANENTLY DELETE ALL DATA?\n\nThis will destroy:\n- All conversations\n- All agents and workflows\n- All documents\n- All user accounts\n\nThere is NO recovery from this!')) {
        alert('All data has been permanently deleted.');
      }
    }

    function logout() {
      localStorage.removeItem('token');
      window.location.href = '/login.html';
    }
  </script>
</body>
</html>
